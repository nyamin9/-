# 🎰 02_01. 판별분석  

<br>  

🎲 용어 정리  

- 공분산 (covariance) : 하나의 변수가 다른 변수와 함께 변화하는 정도(유사한 크기와 방향)를 측정하는 지표  

- 판별함수 (discriminant function) : 독립변수에 적용했을 때, 클래스를 가장 잘 구분하는 함수  

- 판별 가중치 (discriminant weight) : 판별함수를 적용하여 얻은 점수를 말하며, 어떤 클래스에 속할 확률을 추정하는 데 사용  

<br>  

🎲 여러 가지 판별분석 방법 중 가장 일반적으로 사용되는 것은 선형판별분석(LDA)임.  

🎲 트리 모델이나 로지스틱 회귀와 같은 정교한 기법 이후로는 LDA를 그렇게 많이 사용하지 않음  

🎲 하지만 일부 분야에서는 LDA를 사용하고 있으며, PCA등의 여러 기법과도 연결됨  

<br>  

***  

<br>  

## 🎰 01. 공분산행렬  

<br>   

🎲 판별분석을 이해하려면, 두 개 이상의 변수 사이에 공분산이라는 개념을 알아야 함  

🎲 공분산 : 변수 $x$와 $z$ 사이의 관계를 의미하는 지표  

<br>  

🎲 $\bar{x}$, $\bar{z}$ : 각 변수의 평균  

🎲 $s_{x,z}$ : $x$, $z$ 사이의 공분산  

🎲 $s_{x,z} = \frac{1}{n-1}{\sum_{i=1}}^n(x_i-\bar{x})(z_i-\bar{z})$    (단, $n$ : 레코드의 개수)  

<br>  

🎲 양수는 양의 관계를, 음수는 음의 관계를 나타냄  

🎲 단 [-1, 1] 범위에서 정의되는 상관관계와는 달리 변수 $x$ 와 $z$ 에서 사용하는 척도에 따라 달라짐  

<br>  

🎲 공분산행렬 = $\begin{bmatrix} s_{x}^2&s_{x,z} \\ s_{z,x}&s_{z}^2 \end{bmatrix}$  

<br>  


![image](https://user-images.githubusercontent.com/65170165/224374005-af74fd22-5425-49fa-bdbf-34d78a4e2e0c.png)  




<br>  

***  

<br>  

## 🎰 02. 피셔의 선형판별  

<br>  

🎲 피셔의 선형판별은 두 개의 연속형 변수 $x, z$를 사용해 이진 종속변수 $y$를 예측하여 분류하는 경우 사용  

🎲 독립변수가 정규분포를 따르지 않는 경우 혹은 이진 독립변수에 대해서도 잘 동작함  

<br>  


🎲 그룹 내의 편차와 다른 그룹 간의 편차를 구분하는 방식으로 두 레이블을 구분함  

🎲 이를 위해서 그룹 내의 편차 (내부 제곱합)와 타 그룹 간의 편차 (사이 제곱합)를 측정하여 그 비율이 최대화되는 것을 목표로 함  

🎲 사이 제곱합 : 두 그룹 평균 사이의 거리 제곱  

🎲 내부 제곱합 : 공분산행렬에 의해 가중치가 적용된 각 그룹 내의 평균을 주변으로 퍼져있는 정도  

<br>  

🎲 $\frac{(그룹 내 편차)}{(타 그룹 간 편차)}$ 의 값이 최대화되는 선형결합 $w_xx + w_zz$ 을 찾는 것이 목적임

🎲 이렇게 나누어진 각 그룹은, $y=0$, $y=1$ 에 대해서 두 그룹으로 나누어짐  

🎲 결과적으로, 서로 다른 그룹에 속한 데이터는 $(x_0, z_0)$, $(x_1, Z_1)$ 으로 나뉘어짐 -> 판별분석의 최종목적  



<br>  

***  

<br>  

## 🎰 03. 요약  

<br>  

🎲 판별분석 : 독립변수나 종속변수가 범주형이든 연속형이든 상관없이 잘 동작함  

🎲 공분산행렬을 통해 한 클래스와 다른 클래스에 속한 데이터를 구분하는 선형판별함수를 계산할 수 있음  

🎲 선형판별함수를 통해 각 레코드가 어떤 클래스에 속할지 정하기 위해서 각 클래스에 속할 가중치 혹은 점수를 계산함  

<br>  

***  




