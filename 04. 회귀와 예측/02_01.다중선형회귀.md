# 🎰 02_01. 다중선형회귀  

🎲 독립변수가 여러개인 경우 수식은 이들을 모두 포함하는 다음과 같은 형태가 됨  

$Y = b_0 + b_1X_1 + b_2X_2 + ... + b_pX_p + e$  

🎲 이는 직선의 형태는 아니지만, 각 계수와 그 변수들 사이의 관계는 선형이므로 선형모형으로 취급함  

<br>  

🎲 용어 정리  

- 제곱근평균제곱오차 (RMSE, root mean squared error) : 회귀 시 평균제곱오차의 제곱근. 회귀모형 평가에 가장 널리 사용되는 측정 지표  
   
- 잔차 표준오차 (RSE, residual standard error) : 평균제곱오차와 동일하지만 자유도에 따라 보정된 값  
   
- R-squared : 0에서 1까지 모델에 의해 설명된 분산의 비율 (결정계수 coefficient of determination, R2)  
   
- t 통계량 (t-statistic) : 계수의 표준오차로 나눈 예측변수의 계수. 모델에서 변수의 중요도를 비교하는 기준이 됨  
   
- 가중회귀 (weighted regression) : 서로 다른 가중치를 가진 레코드들을 회귀하는 방법  
   
<br>  

🎲 최소제곱법을 이용한 피팅, 적합값과 잔차 같은 단순선형회귀에서의 모든 개념은 다중선형회귀에도 그대로 적용됨  

$fitted = \hat{Y_{i}} = \hat{b_{0}} + \hat{b_{1}}X_{1,i} + \hat{b_{2}}X_{2,i} + ... + \hat{b_{p}}X_{p,i}$  

<br>  

***  

## 🎰 01. 모형평가  

🎲 제곱근평균제곱오차 (RMSE, root mean squared error) : 예측된 적합값들의 평균제곱오차의 제곱근을 의미함  

전반적인 모델의 정확도를 측정하고 다른 모델과 비교하기 위한 기준으로 사용됨  


$RMSE = \sqrt{\frac{\sum\nolimits_{i=1}^{n}{(y_i - \hat{y_i})^2}}{n}}$  

<br>  


🎲 잔차 표준오차 (RSE, residual standard error) : RMSE를 자유도에 따라 보정한 값  

$RSE = \sqrt{\frac{\sum\nolimits_{i=1}^{n}{(y_i - \hat{y_i})^2}}{n-p-1}}$  

<br>  

실제 선형회귀분석을 할 때, RMSE와 RSE의 차이는 아주 작음  

<br>  

🎲 R-squared (결정계수) : 0에서 1까지의 범위로 모델 데이터의 변동률을 측정하여 모델이 데이터에 얼마나 적합한지 평가함. 회귀분석을 설명하기 위한 용도로 활용.   


$R^2 = 1 - \frac{\sum\nolimits_{i=1}^{n}{(y_i - \hat{y_i})^2}}{\sum\nolimits_{i=1}^{n}{(y_i - \bar{y_i})^2}}$  

<br>  

🎲  adjusted R-squared : 모델에 독립변수가 추가되면 그 성능은 당연히 증가하기에, 더 많은 독립변수를 추가하는 것에 대해 페널티를 가해 결정계수를 산출함  

<br>  

🎲 t-통계량 : 계수가 통계적으로 유의미한 정도, 즉 독립변수와 종속변수를 랜덤하게 재배치했을 때 우연히 얻을 수 있는 범위를 어느 정도 벗어났는지를 측정  

계수의 표준오차 SE에 대해서, 

$t = \frac{\hat{b}}{SE(\hat{b})}$  

<br>  


t통계량이 높고 p-value가 낮을수록 독립변수는 더욱 유의미함  

즉 높은 t 통계량과 0에 가까운 p-value는 독립변수를 모델에 포함해야 된다는 의미이고, 낮은 t 통계량은 독립변수를 삭제할 수 있음을 나타냄  


불필요한 가정을 최소하하고 가장 단순하게 설명한다는 오컴의 면도날 원리에 의해, 이 두 값을 사용해 변수를 선택하는 것은 큰 도움이 됨  

<br>  

***  

## 🎰 02. 교차타당성검사  

🎲 R-squared, F-통계량, t-통계량, p-value는 모두 표본 내에서 산출한 지표임.   

🎲 즉, 모델을 구하는 데 사용했던 데이터를 똑같이 그대로 사용하기 때문에 모델의 성능 확인에 오류가 있을 수 있음  

🎲 따라서 원래 데이터의 일부를 떼어놓고, 모델을 만든 후 떼어놓았던(홀드아웃) 데이터를 모델에 적용하면 모델의 성능 확인이 가능함  

🎲 일반적으로 데이터의 다수는 적합한 모델을 찾는 데 사용하고, 소수는 모델을 테스트하는 데 사용  

🎲 하지만 홀드아웃 샘플을 사용한다 하더라도, 상대적으로 작은 홀드아웃 샘플의 변동성으로 인해 불확실성을 초래할 수 있음  

<br>  

🎲 따라서 하나의 홀드아웃 샘플을 사용하지 않고 여러 개의 홀드아웃 샘플을 사용해 모델의 성능을 확인함  

🎲 이를 교차타당성검사 (cross-validation) 및 k 다중 교차타당성검사 (k-fold cross-validation) 이라고 함  

<br>  

🎲 알고리즘  

1. 1/k의 데이터를 홀드아웃 샘플로 따로 떼어놓음  
2. 남아 있는 데이터로 모델을 훈련시킴  
3. 모델을 1/k 홀드아웃 샘플에 적용하고 필요한 모델 평가 지표를 기록함  
4. 데이터의 첫 번째 1/k을 복원하고 앞서 선택했던 레코드는 제외한 다음 1/k을 따로 보관해둠  
5. 2~3단계를 반복  
6. 모든 레코드가 홀드아웃 샘플로 사용될 때까지 반복  
7. 모델 평가 지표들을 평균과 같은 방식으로 하나의 수치로 결합  
   
<br>  

***  

## 🎰 03. 모형 선택 및 단계적 회귀
