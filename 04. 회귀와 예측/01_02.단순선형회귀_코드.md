# 🎰 01_02. 단순선형회귀  

## 🎰 01.01. R 코드  

```r

## lung 데이터 분포 확인  
## Exposure : 면진에 노출된 햇수
## PEFR : 폐활

setwd("C:\\Users\\yamingu\\Desktop\\statistics data")
lung <- read.csv("LungDisease.csv")
house <- read.csv("house_sales.csv", sep = '')

#install.packages("lubridate")
library(lubridate)

plot(PEFR ~ Exposure, data = lung)
```  

![image](https://user-images.githubusercontent.com/65170165/217433047-f0ea0508-b5be-4de2-a205-82a0e1d283a8.png)  

<br>   

***  


🎲 선형회귀  

- 절편이 있는 선형모델 : `lm(RESPONSE ~ INDEPENDENT, data = DATA)`  
   
- 절편이 없는 선형모델 : `lm(RESPONSE ~ INDEPENDENT - 1, data = DATA)`  
 

```r

## 절편 : 424.583
## 기울기 : -4.185
## 면진에 노출된 년수가 0이면 그때의 폐활량 = 424.583
## 면진에 노출된 년수가 1년 증가할 때마다 -4.185의 비율로 폐활량이 감소

model <- lm(PEFR ~ Exposure, data = lung)
model
```  

```
>>

Call:
lm(formula = PEFR ~ Exposure, data = lung)

Coefficients:
(Intercept)     Exposure  
    424.583       -4.185 
    
```  

<br>  

```r  

## 절편이 없는 선형모델 피팅

model_no_intercept <- lm(PEFR ~ Exposure -1, data = lung)
model_no_intercept
```  
```
>>

Call:
lm(formula = PEFR ~ Exposure - 1, data = lung)

Coefficients:
Exposure  
   20.09  
```  

<br>  

🎲 적합값 : `predict(MODEL)`  


```r 

## 적합값 (예측값) : 오차가 포함되지 않은, 모델로부터 추정한 값

fitted <- predict(model)
fitted  

```  
```  
>>  

       1        2        3        4        5        6        7        8        9       10       11       12 
424.5828 424.5828 424.5828 424.5828 420.3982 416.2137 416.2137 416.2137 412.0291 412.0291 412.0291 412.0291 
      13       14       15       16       17       18       19       20       21       22       23       24 
412.0291 412.0291 407.8445 407.8445 407.8445 407.8445 407.8445 407.8445 403.6599 399.4753 399.4753 399.4753 
      25       26       27       28       29       30       31       32       33       34       35       36 
399.4753 399.4753 395.2908 395.2908 395.2908 395.2908 395.2908 395.2908 395.2908 391.1062 386.9216 382.7370 
      37       38       39       40       41       42       43       44       45       46       47       48 
382.7370 382.7370 374.3679 374.3679 370.1833 370.1833 370.1833 370.1833 370.1833 370.1833 370.1833 370.1833 
      49       50       51       52       53       54       55       56       57       58       59       60 
365.9987 365.9987 365.9987 365.9987 365.9987 365.9987 361.8142 361.8142 361.8142 357.6296 357.6296 353.4450 
      61       62       63       64       65       66       67       68       69       70       71       72 
353.4450 353.4450 353.4450 353.4450 353.4450 349.2604 349.2604 349.2604 349.2604 345.0759 345.0759 345.0759 
      73       74       75       76       77       78       79       80       81       82       83       84 
345.0759 345.0759 345.0759 345.0759 345.0759 345.0759 345.0759 345.0759 345.0759 345.0759 340.8913 340.8913 
      85       86       87       88       89       90       91       92       93       94       95       96 
340.8913 340.8913 340.8913 340.8913 340.8913 340.8913 340.8913 340.8913 340.8913 340.8913 340.8913 340.8913 
      97       98       99      100      101      102      103      104      105      106      107      108 
340.8913 340.8913 340.8913 340.8913 340.8913 340.8913 340.8913 340.8913 336.7067 336.7067 336.7067 336.7067 
     109      110      111      112      113      114      115      116      117      118      119      120 
336.7067 336.7067 336.7067 336.7067 336.7067 336.7067 332.5221 332.5221 332.5221 332.5221 332.5221 332.5221 
     121      122 
328.3375 328.3375 

```  
<br>  

🎲 잔차 : `residuals(MODEL)`  


```r  

## 잔차 = 원래값 - 예측값

resid <- residuals(model)
resid  

```  
```
>>

           1            2            3            4            5            6            7            8 
 -34.5828066  -14.5828066    5.4171934   35.4171934   -0.3982301 -136.2136536    3.7863464  103.7863464 
           9           10           11           12           13           14           15           16 
 197.9709229  177.9709229   17.9709229   -2.0290771  -52.0290771  -92.0290771 -297.8445006  -17.8445006 
          17           18           19           20           21           22           23           24 
  -7.8445006   12.1554994   42.1554994  112.1554994   56.3400759 -199.4753477   -9.4753477  -59.4753477 
          25           26           27           28           29           30           31           32 
  50.5246523  150.5246523  -95.2907712  -75.2907712  -55.2907712  -35.2907712   34.7092288   84.7092288 
          33           34           35           36           37           38           39           40 
 164.7092288  108.8938053  -76.9216182   47.2629583  117.2629583  127.2629583 -124.3678887   35.6321113 
          41           42           43           44           45           46           47           48 
-150.1833123  -70.1833123  -30.1833123  -10.1833123   29.8166877   79.8166877  119.8166877  129.8166877 
          49           50           51           52           53           54           55           56 
-165.9987358 -145.9987358  -45.9987358   -5.9987358   44.0012642   54.0012642   18.1858407   48.1858407 
          57           58           59           60           61           62           63           64 
  88.1858407 -137.6295828  -37.6295828 -223.4450063 -133.4450063  -33.4450063    6.5549937    6.5549937 
          65           66           67           68           69           70           71           72 
 136.5549937 -129.2604298 -119.2604298  -39.2604298  110.7395702 -185.0758534 -145.0758534 -125.0758534 
          73           74           75           76           77           78           79           80 
 -65.0758534  -55.0758534  -35.0758534  -25.0758534  -15.0758534   14.9241466   44.9241466   54.9241466 
          81           82           83           84           85           86           87           88 
  84.9241466  164.9241466 -190.8912769 -150.8912769 -140.8912769 -130.8912769 -100.8912769 -120.8912769 
          89           90           91           92           93           94           95           96 
 -90.8912769  -80.8912769  -60.8912769  -50.8912769  -40.8912769  -30.8912769  -20.8912769  -10.8912769 
          97           98           99          100          101          102          103          104 
  19.1087231   49.1087231   59.1087231   89.1087231  119.1087231  129.1087231  149.1087231  209.1087231 
         105          106          107          108          109          110          111          112 
 -56.7067004  -46.7067004  -16.7067004   -6.7067004   13.2932996   33.2932996   53.2932996   63.2932996 
         113          114          115          116          117          118          119          120 
 173.2932996  193.2932996  -52.5221239   27.4778761   67.4778761  117.4778761  157.4778761  167.4778761 
         121          122 
  41.6624526   61.6624526
  
```  
<br>  


```r  

## 실제 데이터와 회귀선 비교  

## 실제 데이터
plot(lung$Exposure, lung$PEFR, xlab="Exposure", ylab="PEFR")

## 
abline(a=model$coefficients[1], b=model$coefficients[2], col="red", lwd=1.5)

```  

![image](https://user-images.githubusercontent.com/65170165/217434854-8da8313e-a5a5-4b9d-8a29-2299af713156.png)  

<br>  

***  

## 🎰 01.02. python 코드  

```py

## 라이브러리 임포트
import pandas as pd
import numpy as np
import os

import matplotlib.pyplot as plt
import statsmodels

from sklearn.linear_model import LinearRegression


## 데이터 임포트
os.chdir('C:\\Users\\yamingu\\Desktop\\statistics data')

lung = pd.read_csv("LungDisease.csv")
house = pd.read_csv("house_sales.csv", sep = '\t')

```  


🎲 선형회귀  

`model = LinearRegression()`  

`model.fit(DATA[INDEPENDENT], DATA[RESPONSE])`  

```py

## 절편 : 424.583
## 기울기 : -4.185
## 면진에 노출된 년수가 0이면 그때의 폐활량 = 424.583
## 면진에 노출된 년수가 1년 증가할 때마다 -4.185의 비율로 폐활량이 감소

predictors = ['Exposure']
outcome = 'PEFR'


model = LinearRegression()

# model.fit(독립변수, 종속변수) -> model.fit(데이터프레임, 시리즈)
model.fit(lung[predictors], lung[outcome])


print(f'Intercept : {model.intercept_:.3f}')
print(f'Coefficient Exposure : {model.coef_[0]:.3f}') 

```  
```
>>

Intercept : 424.583
Coefficient Exposure : -4.185

```  

<br>  

🎲 적합값 : `fitted = model.predict(DATA[INDEPENDENT])`  

🎲 잔차 : `residuals = DATA[RESPONSE] - fitted`  

```py

## 적합값 : 오차가 포함되지 않은, 모델로부터 추정한 값
fitted = model.predict(lung[predictors])


## 잔차 = 원래값 - 적합값
residuals = lung[outcome] - fitted


## 실제 데이터와 회귀선 비교
## 실제값
ax = lung.plot.scatter(x='Exposure', y='PEFR', figsize=(6, 6))

## 적합값
ax.plot(lung.Exposure, fitted)

for x, yactual, yfitted in zip(lung.Exposure, lung.PEFR, fitted): 
    ax.plot((x, x), (yactual, yfitted), '--', color='C1')

plt.tight_layout()
plt.show()

```  
  
![image](https://user-images.githubusercontent.com/65170165/217440105-59301919-902f-45ff-bf4e-05b4606ef865.png)  

<br>  

***  

  
