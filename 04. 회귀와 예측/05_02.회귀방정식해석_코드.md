# ğŸ° 05_02. íšŒê·€ë°©ì •ì‹ í•´ì„  

## ğŸ° 05.01. R ì½”ë“œ  

ğŸ² ë…ë¦½ë³€ìˆ˜ ê°„ ìƒê´€  

```r

## íšŒê·€ê³„ìˆ˜ ê²€í†  - ìƒì‹ì ìœ¼ë¡œ ì˜³ì§€ ì•Šì€ ë¶€ë¶„ ë°œê²¬

## Bedroomì˜ ê³„ìˆ˜ê°€ ìŒìˆ˜ -> ì¹¨ì‹¤ì˜ ìˆ˜ê°€ ëŠ˜ì–´ë‚ ìˆ˜ë¡ ì£¼íƒì˜ ê°€ì¹˜ê°€ ë‚®ì•„ì§
## ì´ëŠ” ë…ë¦½ë³€ìˆ˜ë“¤ì´ ì„œë¡œ ì—°ê´€ë˜ì–´ ìˆê¸° ë•Œë¬¸

## ì§‘ì´ í´ìˆ˜ë¡ ë” ë§ì€ ì¹¨ì‹¤ì´ ìˆì„ ê°€ëŠ¥ì„±ì´ ìˆìœ¼ë©°, ì¹¨ì‹¤ ìˆ˜ë³´ë‹¤ëŠ” ì£¼íƒì˜ í¬ê¸°ê°€ ë” í° ì˜í–¥ì„ ì¤Œ
## í•˜ì§€ë§Œ ê°™ì€ í¬ê¸°ì˜ ì§‘ì´ë¼ë©´ ë” ì ì€ ì¹¨ì‹¤ì„ ì›í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ê¸°ì—, 
## ì¹¨ì‹¤ì˜ ìˆ˜ê°€ ëŠ˜ì–´ë‚ ìˆ˜ë¡ ì˜¤íˆë ¤ ì§‘ì˜ ê°€ì¹˜ê°€ ë–¨ì–´ì§

## ì´ë ‡ê²Œ ìƒí˜¸ ì—°ê´€ëœ ë…ë¦½ë³€ìˆ˜ ì‚¬ìš© ì‹œ íšŒê·€ê³„ìˆ˜ì˜ ë¶€í˜¸ì™€ ì˜ë¯¸ í•´ì„ì´ ì–´ë ¤ì›€
## íšŒê·€ê³„ìˆ˜ ì¶œë ¥

step$coefficients  

```  

```
>>

 (Intercept)             SqFtTotLiving                 Bathrooms                  Bedrooms 
6.178645e+06              1.992776e+02              4.239616e+04             -5.194738e+04 

   BldgGrade PropertyTypeSingle Family     PropertyTypeTownhouse            SqFtFinBasement 
1.371596e+05              2.291206e+04              8.447916e+04              7.046975e+00 

     YrBuilt 
-3.56542e+03

```  

<br>  


ğŸ² ë…ë¦½ë³€ìˆ˜ ì œê±° : `update(MODEL, . ~ . - X_INDEPENDENT1 - X_INDEPENDENT2 - ... )`  


```r  

## update í•¨ìˆ˜ : ë…ë¦½ë³€ìˆ˜ ì¶”ê°€ í˜¹ì€ ì œê±°
## ì¹¨ì‹¤ ìˆ˜ì— ëŒ€í•œ íšŒê·€ê³„ìˆ˜ê°€ ì–‘ìˆ˜ì„ì„ í™•ì¸

update(step, . ~ . - SqFtTotLiving - SqFtFinBasement - Bathrooms)

```  

```
>>

Call:
lm(formula = AdjSalePrice ~ Bedrooms + BldgGrade + PropertyType + 
    YrBuilt, data = house, na.action = na.omit)

Coefficients:
              (Intercept)                   Bedrooms                  BldgGrade  
                  4913973                      27151                     248998  
PropertyTypeSingle Family      PropertyTypeTownhouse                    YrBuilt  
                   -19898                     -47355                      -3212  

```  

<br>  

ğŸ² êµë€ë³€ìˆ˜  

```r

## íšŒê·€ë°©ì •ì‹ì— ì¤‘ìš”í•œ ë³€ìˆ˜ê°€ í¬í•¨ë˜ì§€ ëª»í•´ì„œ ìƒê¸°ëŠ” ëˆ„ë½ì˜ ë¬¸ì œ
## ì£¼íƒ ìœ„ì¹˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ìš”ì¸ë³€ìˆ˜ë¥¼ ì¶”ê°€í•´ íšŒê·€ë¶„ì„ ì§„í–‰
## ZipGroup ì´ ì˜í–¥ë ¥ì´ ìˆëŠ” ë³€ìˆ˜ë¼ëŠ” ê²ƒì„ íšŒê·€ê³„ìˆ˜ë¥¼ í†µí•´ ê´€ì°° ê°€ëŠ¥

lm(formula = AdjSalePrice ~ SqFtTotLiving + SqFtLot + Bathrooms + 
     Bedrooms + BldgGrade + PropertyType + as.factor(ZipGroup), data = house, na.action = na.omit)  
     
```  
```
>>

Call:
lm(formula = AdjSalePrice ~ SqFtTotLiving + SqFtLot + Bathrooms + 
    Bedrooms + BldgGrade + PropertyType + as.factor(ZipGroup), 
    data = house, na.action = na.omit)

Coefficients:
              (Intercept)              SqFtTotLiving                    SqFtLot  
               -6.666e+05                  2.106e+02                  4.550e-01  
                Bathrooms                   Bedrooms                  BldgGrade  
                5.928e+03                 -4.168e+04                  9.854e+04  
PropertyTypeSingle Family      PropertyTypeTownhouse       as.factor(ZipGroup)2  
                1.932e+04                 -7.820e+04                  5.332e+04  
     as.factor(ZipGroup)3       as.factor(ZipGroup)4       as.factor(ZipGroup)5  
                1.163e+05                  1.784e+05                  3.384e+05  

```  

<br>  

ğŸ² ìƒí˜¸ì‘ìš©ê³¼ ì£¼íš¨ê³¼ : `*ìì—°ì‚°ì` 

```r

## * ì—°ì‚°ì -> ë³€ìˆ˜ì˜ ìƒí˜¸ì‘ìš© í‘œì‹œ

## ì£¼íƒì˜í¬ê¸°(SqFtTotLiving)ì™€ ìœ„ì¹˜(ZipGroup)ì—ëŠ” ê°•í•œ ìƒí˜¸ì‘ìš©ì´ ìˆëŠ” ê²ƒìœ¼ë¡œ ë³´ì„
## ì£¼íƒì˜ í¬ê¸°ì— ëŒ€í•´ì„œ ì£¼íƒì˜ ìœ„ì¹˜ê°€ ë¹„ì‹¼ ì§€ì—­ì¼ìˆ˜ë¡, ì£¼íƒì˜ ê°€ê²©ì€ ë” ê°€íŒŒë¥¸ ìƒìŠ¹ ê¸°ìš¸ê¸°ë¥¼ ë³´ì—¬ì¤Œ
## ê°€ê²©ëŒ€ê°€ ê°€ì¥ ë‚®ì€ ìœ„ì¹˜ì˜ ì£¼íƒì˜ ê°€ê²©ì— ëŒ€í•œ ê¸°ìš¸ê¸°ëŠ” SqFtTotLivingì˜ íšŒê·€ê³„ìˆ˜ì™€ ë™ì¼
## ë°˜ë©´ ê°€ì¥ ë¹„ì‹¼ ìœ„ì¹˜ì˜ ì£¼íƒì˜ ê¸°ìš¸ê¸°ëŠ” SqFtTotLivingì˜ íšŒê·€ê³„ìˆ˜ì— 
## SqFtTotLiving:as.factor(ZipGroup)5 ì˜ íšŒê·€ê³„ìˆ˜ë¥¼ ë”í•œ 342 ë‹¬ëŸ¬ ì •ë„ì„

## ì¦‰, ê°€ê²©ëŒ€ê°€ ê°€ì¥ ë¹„ì‹¼ ì§€ì—­ì˜ ì£¼íƒì˜ ê²½ìš° ì£¼íƒ í¬ê¸°ê°€ 1ì œê³±í”¼íŠ¸ ì¦ê°€ ì‹œ 
## ê°€ê²©ëŒ€ê°€ ê°€ì¥ ë‚®ì€ ì§€ì—­ì—ì„œì˜ í‰ê· ì ì¸ ìƒìŠ¹ì— ë¹„í•´ 3ë°° ì •ë„ ì°¨ì´ê°€ ë°œìƒí•¨

lm(formula = AdjSalePrice ~ SqFtTotLiving * as.factor(ZipGroup) + SqFtLot + 
     Bathrooms + Bedrooms + BldgGrade + PropertyType, data = house, na.action = na.omit)
     
```  

```
>>

Call:
lm(formula = AdjSalePrice ~ SqFtTotLiving * as.factor(ZipGroup) + 
    SqFtLot + Bathrooms + Bedrooms + BldgGrade + PropertyType, 
    data = house, na.action = na.omit)

Coefficients:
                       (Intercept)                       SqFtTotLiving  
                        -4.853e+05                           1.148e+02  
              as.factor(ZipGroup)2                as.factor(ZipGroup)3  
                        -1.113e+04                           2.032e+04  
              as.factor(ZipGroup)4                as.factor(ZipGroup)5  
                         2.050e+04                          -1.499e+05  
                           SqFtLot                           Bathrooms  
                         6.869e-01                          -3.619e+03  
                          Bedrooms                           BldgGrade  
                        -4.180e+04                           1.047e+05  
         PropertyTypeSingle Family               PropertyTypeTownhouse  
                         1.357e+04                          -5.884e+04  
SqFtTotLiving:as.factor(ZipGroup)2  SqFtTotLiving:as.factor(ZipGroup)3  
                         3.260e+01                           4.178e+01  
SqFtTotLiving:as.factor(ZipGroup)4  SqFtTotLiving:as.factor(ZipGroup)5  
                         6.934e+01                           2.267e+02  

```  

<br>  

***  

## ğŸ° 05.02. python ì½”ë“œ  

ğŸ² ë…ë¦½ë³€ìˆ˜ ê°„ ìƒê´€  


```py

## íšŒê·€ê³„ìˆ˜ ê²€í†  - ìƒì‹ì ìœ¼ë¡œ ì˜³ì§€ ì•Šì€ ë¶€ë¶„ ë°œê²¬

## Bedroomì˜ ê³„ìˆ˜ê°€ ìŒìˆ˜ -> ì¹¨ì‹¤ì˜ ìˆ˜ê°€ ëŠ˜ì–´ë‚ ìˆ˜ë¡ ì£¼íƒì˜ ê°€ì¹˜ê°€ ë‚®ì•„ì§
## ì´ëŠ” ë…ë¦½ë³€ìˆ˜ë“¤ì´ ì„œë¡œ ì—°ê´€ë˜ì–´ ìˆê¸° ë•Œë¬¸

## ì§‘ì´ í´ìˆ˜ë¡ ë” ë§ì€ ì¹¨ì‹¤ì´ ìˆì„ ê°€ëŠ¥ì„±ì´ ìˆìœ¼ë©°, ì¹¨ì‹¤ ìˆ˜ë³´ë‹¤ëŠ” ì£¼íƒì˜ í¬ê¸°ê°€ ë” í° ì˜í–¥ì„ ì¤Œ
## í•˜ì§€ë§Œ ê°™ì€ í¬ê¸°ì˜ ì§‘ì´ë¼ë©´ ë” ì ì€ ì¹¨ì‹¤ì„ ì›í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ê¸°ì—, 
## ì¹¨ì‹¤ì˜ ìˆ˜ê°€ ëŠ˜ì–´ë‚ ìˆ˜ë¡ ì˜¤íˆë ¤ ì§‘ì˜ ê°€ì¹˜ê°€ ë–¨ì–´ì§

## ì´ë ‡ê²Œ ìƒí˜¸ ì—°ê´€ëœ ë…ë¦½ë³€ìˆ˜ ì‚¬ìš© ì‹œ íšŒê·€ê³„ìˆ˜ì˜ ë¶€í˜¸ì™€ ì˜ë¯¸ í•´ì„ì´ ì–´ë ¤ì›€

print(f'Intercept: {best_model.intercept_:.3f}')
print('Coefficients:')
for name, coef in zip(best_variables, best_model.coef_):
    print(f' {name}: {coef}')
    
```  
```
>>

Intercept: 6178645.017
Coefficients:
 SqFtTotLiving: 199.2775530420156
 BldgGrade: 137159.56022620026
 YrBuilt: -3565.4249392493202
 Bedrooms: -51947.38367361377
 Bathrooms: 42396.1645277189
 PropertyType_Townhouse: 84479.16203300135
 SqFtFinBasement: 7.046974967572117
 PropertyType_Single Family: 22912.05518701778
 
```  

<br>  

```py

## ë…ë¦½ë³€ìˆ˜ ì œê±°
## íŒŒì´ì¬ì€ ë…ë¦½ë³€ìˆ˜ ì¬ì„¤ì •ì„ ìœ„í•œ í•¨ìˆ˜ê°€ ì—†ìŒ -> ë…ë¦½ë³€ìˆ˜ì˜ì¬ì •ì˜
## ì¹¨ì‹¤ ìˆ˜ì— ëŒ€í•œ íšŒê·€ê³„ìˆ˜ê°€ ì–‘ìˆ˜ì„ì„ í™•ì¸

predictors = ['Bedrooms', 'BldgGrade', 'PropertyType', 'YrBuilt']
outcome = 'AdjSalePrice'

X = pd.get_dummies(house[predictors], drop_first=True)

reduced_lm = LinearRegression()
reduced_lm.fit(X, house[outcome])

print(f'Intercept: {reduced_lm.intercept_:.3f}')
print('Coefficients:')
for name, coef in zip(X.columns, reduced_lm.coef_):
    print(f' {name}: {coef}')
    
```  

```
>>

Intercept: 4913973.344
Coefficients:
 Bedrooms: 27150.5372302151
 BldgGrade: 248997.79366213712
 YrBuilt: -3211.744862155117
 PropertyType_Single Family: -19898.495340502337
 PropertyType_Townhouse: -47355.43687334474
 
```  

<br>  

ğŸ² êµë€ë³€ìˆ˜  

```py

## íšŒê·€ë°©ì •ì‹ì— ì¤‘ìš”í•œ ë³€ìˆ˜ê°€ í¬í•¨ë˜ì§€ ëª»í•´ì„œ ìƒê¸°ëŠ” ëˆ„ë½ì˜ ë¬¸ì œ
## ì£¼íƒ ìœ„ì¹˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ìš”ì¸ë³€ìˆ˜ë¥¼ ì¶”ê°€í•´ íšŒê·€ë¶„ì„ ì§„í–‰

predictors = ['SqFtTotLiving', 'SqFtLot', 'Bathrooms', 'Bedrooms', 'BldgGrade', 'PropertyType', 'ZipGroup']
outcome = 'AdjSalePrice'

X = pd.get_dummies(house[predictors], drop_first=True)

confounding_lm = LinearRegression()
confounding_lm.fit(X, house[outcome])

print(f'Intercept: {confounding_lm.intercept_:.3f}')
print('Coefficients:')
for name, coef in zip(X.columns, confounding_lm.coef_):
    print(f' {name}: {coef}')
    
```  

```
>>

Intercept: -666637.469
Coefficients:
 SqFtTotLiving: 210.61266005580177
 SqFtLot: 0.4549871385466008
 Bathrooms: 5928.425640001766
 Bedrooms: -41682.871840744825
 BldgGrade: 98541.18352725946
 PropertyType_Single Family: 19323.625287919505
 PropertyType_Townhouse: -78198.72092762394
 ZipGroup_1: 53317.173306598015
 ZipGroup_2: 116251.58883563553
 ZipGroup_3: 178360.53178793378
 ZipGroup_4: 338408.60185652017
 
```  

<br>  

ğŸ² ìƒí˜¸ì‘ìš©ê³¼ ì£¼íš¨ê³¼  

- `MODEL = smf.ols(formula = 'RESPONSE ~ INDEPENDENT1 * INDEPENDENT2 + ... + INDEPENDENT_n', data = DATA)`  
   
- `results = MODEL.fit()`  
   
- `results.summary()`  
 

```py

import statsmodels.api as sm
import statsmodels.formula.api as smf
from statsmodels.stats.outliers_influence import OLSInfluence

# * ì—°ì‚°ì -> ë³€ìˆ˜ì˜ ìƒí˜¸ì‘ìš© í‘œì‹œ

## ì£¼íƒì˜í¬ê¸°(SqFtTotLiving)ì™€ ìœ„ì¹˜(ZipGroup)ì—ëŠ” ê°•í•œ ìƒí˜¸ì‘ìš©ì´ ìˆëŠ” ê²ƒìœ¼ë¡œ ë³´ì„
## ì£¼íƒì˜ í¬ê¸°ì— ëŒ€í•´ì„œ ì£¼íƒì˜ ìœ„ì¹˜ê°€ ë¹„ì‹¼ ì§€ì—­ì¼ìˆ˜ë¡, ì£¼íƒì˜ ê°€ê²©ì€ ë” ê°€íŒŒë¥¸ ìƒìŠ¹ ê¸°ìš¸ê¸°ë¥¼ ë³´ì—¬ì¤Œ

## ê°€ê²©ëŒ€ê°€ ê°€ì¥ ë‚®ì€ ìœ„ì¹˜ì˜ ì£¼íƒì˜ ê°€ê²©ì— ëŒ€í•œ ê¸°ìš¸ê¸°ëŠ” SqFtTotLivingì˜ íšŒê·€ê³„ìˆ˜ì™€ ë™ì¼
## ë°˜ë©´ ê°€ì¥ ë¹„ì‹¼ ìœ„ì¹˜ì˜ ì£¼íƒì˜ ê¸°ìš¸ê¸°ëŠ” SqFtTotLivingì˜ íšŒê·€ê³„ìˆ˜ì— 
## SqFtTotLiving:as.factor(ZipGroup)5 ì˜ íšŒê·€ê³„ìˆ˜ë¥¼ ë”í•œ 342 ë‹¬ëŸ¬ ì •ë„ì„

## ì¦‰, ê°€ê²©ëŒ€ê°€ ê°€ì¥ ë¹„ì‹¼ ì§€ì—­ì˜ ì£¼íƒì˜ ê²½ìš° ì£¼íƒ í¬ê¸°ê°€ 1ì œê³±í”¼íŠ¸ ì¦ê°€ ì‹œ 
## ê°€ê²©ëŒ€ê°€ ê°€ì¥ ë‚®ì€ ì§€ì—­ì—ì„œì˜ í‰ê· ì ì¸ ìƒìŠ¹ì— ë¹„í•´ 3ë°° ì •ë„ ì°¨ì´ê°€ ë°œìƒí•¨

model = smf.ols(formula = 'AdjSalePrice ~ SqFtTotLiving * ZipGroup + SqFtLot + Bathrooms + Bedrooms + BldgGrade + PropertyType', data = house)

results = model.fit()
results.summary()

```  

![image](https://user-images.githubusercontent.com/65170165/217568314-2058a139-f566-43a5-8afd-5ca22045854a.png)  

<br>  

***  





