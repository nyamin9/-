# 🎰 03. 회귀를 이용한 예측  

🎲 데이터 과학에서 회귀의 주된 목적은 예측임  

<br>  

🎲 용어 정리  

- 예측구간 (prediction interval) : 개별 예측값 주위의 불확실한 구간  
   
- 외삽법 (extrapolation) : 모델링에 사용된 데이터 범위를 벗어난 부분까지 모델을 확장하는 것  
   
<br>  

***  

## 🎰 01. 외삽의 위험  

회귀모형을 데이터 범위를 초과하면서까지 외삽하는 데 사용해서는 안됨  

회귀모형은 충분한 데이터 값이 있는 독립변수에 대해서만 유효함  

즉, 모델링에 사용하지 않은 영역의 데이터를 예측하는 것은 옳지 않음 -> 데이터 범위를 벗어나는 외삽은 오류를 유발함  


<br>  

***  

## 🎰 02. 신뢰구간과 예측구간  


통계학은 변동성(불확실성)을 이해하고 측정하는 것을 포함  

회귀분석 결과의 t 통계량과 p-value는 변동성을 다루는 일반적인 방법이며, 종종 변수 선택을 위해 활용됨  

이외에 회귀계수와 예측을 둘러싼 불확실성 구간을 의미하는 신뢰구간이 있음  

- 가장 일반적인 회귀 관련 신뢰구간은 회귀 계수의 신뢰구간임  
   
<br>  

🎲 신뢰구간 : 회귀계수 주변의 불확실성을 정량화함  

🎲 예측구간 : 개별 예측값의 불확실성을 정량화함  

<br>  

🎲 P개의 독립변수와 n개의 레코드가 있는 데이터에 대해 회귀계수의 신뢰구간을 구하기 위한 부트스트랩 알고리즘  

1. 개수가 모두 n개인 행을 모두 박스에 넣었다고 가정  
2. 무작위로 행을 뽑아 값을 기록하고 다시 박스에 넣음  
3. 2번 과정을 n번 반복해 부트스트랩 재표본을 하나 생성함  
4. 이 부트스트랩 표본을 가지고 회귀모형을 구하고 추정된 계수들을 기록함  
5. 2~4번 과정을 1,000번 반복  
6. 그 결과 각 계수에 대해 1,000개의 부트스트랩 값을 갖게 됨.  
7. 각각에 대해 적합한 백분위수를 구함 (예를 들어 90% 신뢰구간을 위해 5번째에서 95번째 백분위수를 구함)  
   
<br>  

특히 회귀계수의 값과 예측된 Y값의 구간(예측구간, ≠ 신뢰구간)을 알아보는 것이 중요함  

예측 및 신뢰 구간 생성을 위해 수식 대신 부트스트랩을 사용할 수도 있음  


예측된 Y값의 불확실성은 아래 두 가지 원인에서 비롯됨  

- 무엇이 적합한 예측변수인지, 그리고 계수가 얼마인지에 따른 불확실성  
   
- 개별 데이터 값에 존재하는 추가적인 오류  
   
<br>  

이때 회귀방정식이 무엇인지 정확히 안다고 해도 주어진 독립변숫값에 의한 실제 결괏값은 달라질 수 있음 -> 따라서 이 두 값의 차이로 인해 개별 데이터 값의 오차가 발생함  

이 개별 오차를 적합값으로부터의 잔차로 모델링할 수 있음  

<br>  

🎲 회귀모형에 따른 오차와 개별 데이터 값에 따른 오차를 모델링하기 위한 부트스트랩 알고리즘  

1. 데이터로부터 부트스트랩 표본을 추출함  
2. 회귀모형을 찾고 새로운 값을 예측  
3. 원래의 회귀 적합도에서 임의로 하나의 잔차를 취하여 예측값에 더하고 그 결과를 기록  
4. 1~3단계를 1,000번 반복  
5. 95% 신뢰구간을 위해 2.5번째 백분위수와 97.5번째 백분위수를 찾음  
   
<br>  

🎲 예측구간 vs 신뢰구간  

- 예측구간은 하나의 값에 대한 불확실성과 관련되는 반면, 신뢰구간은 여러 값에서 계산된 평균이나 다른 통계량과 관련됨  
   
- 따라서 예측구간은 일반적으로 같은 값에 대해 신뢰구간보다 훨씬 넓음  
   
- 부트스트랩 모델에서 예측값에 추가할 개별 잔차를 선택하는 방식으로 이 개별 값의 오차를 모델링함  
   
- 만약 예측구간을 사용해야 하는데 신뢰구간을 사용하면 주어진 예측값의 불확실성이 지나치게 낮은 것으로 나올 수 있음  
   
<br>  

***  
