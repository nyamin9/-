# 🎰 10. 멀티암드 밴딧 알고리즘  

🎲 전통적인 통계 방식보다 명시적인 최적화와 좀 더 빠른 의사결정을 가능케 함  

🎲 특히 웹 테스트에 사용됨  

<br>  

🎲 용어 정리  

- 멀티암드 밴딧 (multi-armed bandit) : 다중 처리 실험에 대한 비유로써, 고객이 선택할 수 있는 손잡이가 여러 개인 가상의 슬롯머신을 말함. 각 손잡이는 각기 다른 수익을 가져다줌.  
   
- 손잡이 (arm) : 실험에서 어떤 하나의 처리를 의미함 (웹 테스트에서 각기 다른 헤드라인, 색상)  
   
- 수익 (win) : 슬롯머신으로 딴 상금에 대한 실험적 비유 (고객들의 링크 클릭 수)  
   
 <br>  
 
🎲 A/B 검정은 특정하게 설계된 실험을 통해 수집된 데이터를 이용하여 ‘처리 A, 처리 B 둘 중 어느 쪽이 더 좋은가?’ 와 같이 정해진 질문에 대한 답을 제공  

🎲 답을 얻고 나면 실험은 멈추고 결과에 따라 행동함  

<br>  

🎲 하지만 몇 가지 어려움이 존재할 수 있음  

- 결론을 내리기 어려움 : 실험 결과를 통해 유효하다는 것을 유추할 수는 있지만, 이를 입증할 만한 (일반적인 기준치를 만족시킬 만한) 크기의 표본이 없을 수 있음  
   
- 실험이 끝나기 전에 이미 얻은 결과들을 이용해 그 결과에 대한 신뢰도가 떨어질 수 있음  
   
- 실험이 끝난 후에 추가적으로 들어오는 데이터를 기반으로 또 다른 것을 시도하고 싶을 수 있음  
 
<br>  

🎲 멀티암드 밴딧 알고리즘은 여러 개의 손잡이 중에서 어느 것을 당겨애 더 많은 수익을 올릴 수 있을지 결정하는 방법을 찾는 것이 목표임  

🎲 가능한 많은 수익을 얻음과 동시에 빠르게 그 손잡이를 결정하는 것이 우리의 목적  

<br>  


🎲 손잡이를 돌렸을 때 나오는 개별적인 결과는 알 수 있지만, 각 손잡이에 대해 우리가 지불해야 하는 손실은 전혀 모름  

🎲 어떤 손잡이든지 간에 상금의 금액은 모두 같고 수익을 얻을 확률만 다른 상황을 가정했을 때 우리는 두 가지 극단적인 선택이 가능함  

- 50회 돌렸을 때 가장 많이 승리한 손잡이만 계속 잡아당기는 선택  
  - 초기에 많은 수익을 얻을 수는 있으나 다른 손잡이가 더 좋은 경우의 수익은 아예 얻을 수 없음  
     
- 모든 손잡이가 무작위로 보이므로 모두 똑같이 잡아당기는 선택  
  - 이를 통해 가장 잘 나오는 손잡이 외에도 다른 손잡이들의 확률 파악이 가능하지만, 수익이 낮을 것이라 예상되는 시도를 계속해야 함  
<br>  


🎲 이렇게 각각의 손잡이를 잡아당기는 시도의 횟수를 파악하기 위해 하이브리드 방식을 사용함  

- 처음에는 확률이 큰 손잡이의 우위 활용을 위해 이를 더 자주 잡아당기는 것으로 시작함. 그렇다고 다른 손잡이를 포기하지는 않음.  
   
- 만약 계속해서 좋은 성과를 얻는다면 다른 손잡이를 돌릴 기회를 좋은 확률의 손잡이에게 할당함  
   
- 반면 다른 손잡이가 점점 좋아지고, 해당 손잡이는 성과가 나빠지기 시작하면 그 시행의 횟수를 점점 다른 손잡이에 부여함  
   
- 만약 다른 손잡이들 중 하나의 성능이 더욱 우수함이 밝혀진다면, 더 많은 테스트를 통해 그 결과를 밝힐 수 있음  
   
<br>  

🎲 처음에는 여러 제안이 무작위로 균등하게 표시되다가, 어떤 제안이 다른 제안들 보다 좋은 성능을 보인다면 그 제안을 더 자주 표시하기 시작함  

<br>  


🎲 손잡이를 잡아당기는 비율을 수정하는 알고리즘 : 엡실론-그리디 알고리즘 (epsilon-greedy algorithm)  

1. 0부터 1 사이의 균등분포의 난수를 생성  
2. 이 난수가 0과 엡실론 (0과 1 사이의 아주 작은 값. 단일 파라미터) 사이에 존재하는 경우 50/50의 확률로 동전 뒤집기를 시행  
3. 동전이 앞면이면 제안 A를 표시  
4. 동전이 뒷면이면 제안 B를 표시  
5. 난수가 엡실론보다 크면, 지금까지 가장 좋은 결과를 보인 제안을 표시함  
   
🎲 만약 앱실론이 1이면 간단한 표준 A/B 검정(매 실험마다 A와 B를 무작위로 할당)을 하게 됨  

🎲 엡실론이 0이라면 greedy algorithm이 되어버림. 즉 당장 최상의 즉각적인 옵션을 선택하게 되며 더 이상의 실험 없이, 피실험자들을 항상 지금까지 알려진 가장 좋은 제안에 할당함  

<br>  

🎲 톰슨의 샘플링 Thompson’s sampling  

- 어느 것이 가장 좋은 손잡이인지 모르지만, 각 단계마다 손잡이를 당 최고의 손잡이를 선택할 확률을 최대화함  
   
- 하지만 손잡이를 매 시도마다 당김으로써 추출한 연속적인 표본을 바탕으로 더 많은 정보를 얻을 수 있음  
   
- 베타 분포를 통해 수익의 일반 사전 분포를 가정해두고, 베이즈 방식을 사용함  
   
- 결과적으로 각 추출 정보가 누적되면서 정보가 업데이트되기 때문에, 다음번에 수익이 좋은 손잡이를 선택할 확률을 효과적으로 최적화할 수 있음  
   
<br>  

🎲 밴딧 알고리즘은 3가지 이상의 처리를 효율적으로 다루고 ‘최고’를 위한 최적의 선택을 하도록 도와줌.  

🎲 일반적으로 3가지 이상의 처리에 대한 의사 결정은 A/B 테스트에 비해 월씬 복잡하므로, 이때 밴딧 알고리즘의 장점이 더욱 커짐  

🎲 또한 A/B 테스트는 임의표본추출 과정을 기본으로 하기에 수익이 낮은 것을 너무 많이 시도할 수 있음  

🎲 이와 대조적으로 멀티 밴딧 알고리즘은 실험 도중에 얻은 정보를 통합하고 수익이 낮은 것의 빈도를 줄이는 쪽으로 표본추출 과정을 변경함  

<br>  

***  
