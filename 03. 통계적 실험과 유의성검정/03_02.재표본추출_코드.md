# ğŸ° 03_02. ì¬í‘œë³¸ì¶”ì¶œ  


## ğŸ° 03.01. R ì½”ë“œ  

<br>  


```r
setwd("C:\\Users\\yamingu\\Desktop\\statistics data")
webpage <- read.csv("web_page_data.csv")
webpage

library(ggplot2)
```  

<br>  

ğŸ² ê° ê·¸ë£¹ì˜ ë¶„í¬ í™•ì¸

```r
# box plot -> í˜ì´ì§€ë³„ ì„¸ì…˜ ì‹œê°„ ì‹œê°í™”

ggplot(webpage, aes(x=Page, y = Time)) +
         geom_boxplot()
```  

![image](https://user-images.githubusercontent.com/65170165/212875630-c2c1d275-5c74-4130-98b0-d54c5a9a435f.png)  



<br>  

ğŸ² ì›ë˜ ê·¸ë£¹ Page A / Page B ì˜ ê²€ì •í†µê³„ëŸ‰ ì°¨ì´ ê³„ì‚°

```r
# ê²€ì •í†µê³„ëŸ‰(í‰ê· ) ì°¨ì´ ê³„ì‚°   

mean_a <- mean(webpage[webpage['Page']=='Page A', 'Time']) 
mean_b <- mean(webpage[webpage['Page']=='Page B', 'Time']) 
mean_b - mean_a
```  
```
>> [1] 0.3566667
```  


<br>  

ğŸ² ì¬í‘œë³¸ì¶”ì¶œ  


```r
# perm_fun() í•¨ìˆ˜
# ìˆœì—´ê²€ì • ì ìš©ì„ ìœ„í•œ ê° ê·¸ë£¹(A,21ê°œ / B,15ê°œ)ì— ì„¸ì…˜ì‹œê°„(36ê°œ)ì„ ëœë¤í•˜ê²Œ í• ë‹¹
# ë¹„ë³µì›ì¶”ì¶œë¡œ nBê°œì˜ í‘œë³¸ì„ ì¶”ì¶œí•´ ê·¸ë£¹ Bì— í• ë‹¹
# ë‚˜ë¨¸ì§€ nAê°œëŠ” ê·¸ë£¹ Aì— í• ë‹¹
# ì´ë•Œ ë‘ ê·¸ë£¹ì˜ í‰ê· ì˜ ì°¨ì´ë¥¼ ê²°ê³¼ë¡œ ë°˜í™˜

perm_fun <- function(x, nA, nB)
{
  n <- nA + nB
  idx_b <- sample(1:n, nB)
  idx_a <- setdiff(1:n, idx_b)
  mean_diff <- mean(x[idx_b]) - mean(x[idx_a])
  return(mean_diff)
}  
```

<br>  

ğŸ² ìˆœì—´ê²€ì • êµ¬í˜„ : 1000íšŒ ë°˜ë³µ  


```r
# ìˆœì—´ê²€ì • êµ¬í˜„
# nA = 21, nB = 15 ë¡œ ì„¤ì •í•œ í›„ ì´ë¥¼ 1000íšŒ(RíšŒ) ë°˜ë³µí•¨
# ì´ë ‡ê²Œ ì–»ì€ ì„¸ì…˜ ì‹œê°„ì˜ ì°¨ì´ë¥¼ íˆìŠ¤í† ê·¸ë¨ìœ¼ë¡œ í‘œì‹œí•¨
# perm_diffs : ì¬í‘œë³¸ ê°„ì˜ 1000íšŒ ê²€ì •í†µê³„ëŸ‰ ì°¨ì´ë¥¼ ê³„ì‚°í•œ ë¦¬ìŠ¤íŠ¸ 

perm_diffs <- rep(0,1000)

for (i in 1:1000) {
  perm_diffs[i] = perm_fun(webpage[, 'Time'], 21, 15)
}

hist(perm_diffs, xlab = 'Session Time differences (in seconds)')
abline(v = mean_b - mean_a)  
```  

![image](https://user-images.githubusercontent.com/65170165/212876384-50ebd45e-f69b-4289-9f62-74cd329f79be.png)  

 
<br>  

ğŸ² ì›ë˜ í‘œë³¸ì˜ ê²€ì •í†µê³„ëŸ‰ì´ ì¬í‘œë³¸ì˜ í™•ë¥ ë¶„í¬ì˜ ë²”ìœ„ ë‚´ì— ìˆì„ í™•ë¥  ê³„ì‚°  


```r
# ì‹¤ì œ ê´€ì°°í•œ ë‘ ê·¸ë£¹ ê°„ í‰ê·  ì„¸ì…˜ ì‹œê°„ ì°¨ì´ê°€ ë¬´ì‘ìœ„ ìˆœì—´ë¡œ êµ¬í•œ í‰ê·  ì„¸ì…˜ì˜ ì‹œê°„ ì°¨ì´ì˜ ë¶„í¬ì— í¬í•¨ë¨ 
# ì¦‰ Aê·¸ë£¹ê³¼ Bê·¸ë£¹ì˜ ì„¸ì…˜ ì°¨ì´ê°€ í™•ë¥ ë¶„í¬ì˜ ë²”ìœ„ ë‚´ì— ìˆìœ¼ë¯€ë¡œ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ

mean(perm_diffs > (mean_b - mean_a))  
```  
```
>> [1] 0.139
```  

<br>  

***  

## ğŸ° 03.02. python ì½”ë“œ  

<br>  


```py
import pandas as pd
import matplotlib.pyplot as plt
import random
import numpy as np

import os
os.chdir('C:\\Users\\yamingu\\Desktop\\statistics data')
webpage = pd.read_csv('web_page_data.csv')
```  

<br>  

ğŸ² ê° ê·¸ë£¹ì˜ ë¶„í¬ í™•ì¸  

```py
# box plot -> í˜ì´ì§€ë³„ ì„¸ì…˜ ì‹œê°„ ì‹œê°í™”

ax = webpage.boxplot(by = 'Page', column = 'Time', figsize=(6,6))
ax.set_xlabel('')
ax.set_ylabel('Time (in seconds)')
plt.suptitle('')
```  
![image](https://user-images.githubusercontent.com/65170165/212877495-f11348f4-0ba2-4e19-ab7d-220cf63a5353.png)  

<br>  

ğŸ² ì›ë˜ ê·¸ë£¹ Page A / Page B ì˜ ê²€ì •í†µê³„ëŸ‰ ì°¨ì´ ê³„ì‚°  


```py
# ê²€ì •í†µê³„ëŸ‰(í‰ê· ) ì°¨ì´ ê³„ì‚° 

mean_a = webpage[webpage['Page']=='Page A'].Time.mean()
mean_b = webpage[webpage['Page']=='Page B'].Time.mean()
mean_b - mean_a
```  
```
>> 0.3566666666666669
```  

<br>  

ğŸ² ì¬í‘œë³¸ì¶”ì¶œ  


```py
# perm_fun() í•¨ìˆ˜
# ìˆœì—´ê²€ì • ì ìš©ì„ ìœ„í•œ ê° ê·¸ë£¹(A,21ê°œ / B,15ê°œ)ì— ì„¸ì…˜ì‹œê°„(36ê°œ)ì„ ëœë¤í•˜ê²Œ í• ë‹¹
# ë¹„ë³µì›ì¶”ì¶œë¡œ nBê°œì˜ í‘œë³¸ì„ ì¶”ì¶œí•´ ê·¸ë£¹ Bì— í• ë‹¹
# ë‚˜ë¨¸ì§€ nAê°œëŠ” ê·¸ë£¹ Aì— í• ë‹¹
# ì´ë•Œ ë‘ ê·¸ë£¹ì˜ í‰ê· ì˜ ì°¨ì´ë¥¼ ê²°ê³¼ë¡œ ë°˜í™˜

def perm_fun(x, nA, nB):
    n = nA + nB
    idx_B = set(random.sample(range(n), nB))
    idx_A = set(range(n)) - idx_B
    return x.loc[idx_B].mean() - x.loc[idx_A].mean()
```  

<br>  

ğŸ² ìˆœì—´ê²€ì • êµ¬í˜„ : 1000íšŒ ë°˜ë³µ  


```py
# ìˆœì—´ê²€ì • êµ¬í˜„
# nA = 21, nB = 15 ë¡œ ì„¤ì •í•œ í›„ ì´ë¥¼ 1000íšŒ(RíšŒ) ë°˜ë³µí•¨
# ì´ë ‡ê²Œ ì–»ì€ ì„¸ì…˜ ì‹œê°„ì˜ ì°¨ì´ë¥¼ íˆìŠ¤í† ê·¸ë¨ìœ¼ë¡œ í‘œì‹œí•¨
# perm_diffs : ì¬í‘œë³¸ ê°„ì˜ 1000íšŒ ê²€ì •í†µê³„ëŸ‰ ì°¨ì´ë¥¼ ê³„ì‚°í•œ ë¦¬ìŠ¤íŠ¸ 

perm_diffs = [perm_fun(webpage.Time, 21, 15) for _ in range(1000)]

fig, ax = plt.subplots(figsize = (5,5))
ax.hist(perm_diffs, bins = 11, rwidth = 0.9)
ax.axvline(x = mean_b - mean_a, color = 'black', lw = 2)
ax.text(0.4, 220, 'Observed\ndifference', bbox={'facecolor' : 'white'})
ax.set_xlabel('Session time differences (in seconds)')
ax.set_ylabel('Frequency')
```  

![image](https://user-images.githubusercontent.com/65170165/212878084-e019fb54-9742-4f44-81ef-4eb657b5dcdc.png)  

<br>  

ğŸ² ì›ë˜ í‘œë³¸ì˜ ê²€ì •í†µê³„ëŸ‰ì´ ì¬í‘œë³¸ì˜ í™•ë¥ ë¶„í¬ì˜ ë²”ìœ„ ë‚´ì— ìˆì„ í™•ë¥  ê³„ì‚°  


```py
# ì‹¤ì œ ê´€ì°°í•œ ë‘ ê·¸ë£¹ ê°„ í‰ê·  ì„¸ì…˜ ì‹œê°„ ì°¨ì´ê°€ ë¬´ì‘ìœ„ ìˆœì—´ë¡œ êµ¬í•œ í‰ê·  ì„¸ì…˜ì˜ ì‹œê°„ ì°¨ì´ì˜ ë¶„í¬ì— í¬í•¨ë¨ 
# ì¦‰ Aê·¸ë£¹ê³¼ Bê·¸ë£¹ì˜ ì„¸ì…˜ ì°¨ì´ê°€ í™•ë¥ ë¶„í¬ì˜ ë²”ìœ„ ë‚´ì— ìˆìœ¼ë¯€ë¡œ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•˜ì§€ ì•ŠìŒ

np.mean(np.array(perm_diffs) > mean_b - mean_a)
```  
```
>> 0.15
```  

<br>  

***  




