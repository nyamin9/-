# 🎰 09_01. 카이제곱검정  

🎲 동시에 여러 가지 처리를 한번에 테스트  


🎲 사건 발생 횟수 관련 데이터에 주로 사용되며 예상되는 분포에 얼마나 잘 맞는지를 검정  

🎲 카이제곱통계량 : 일반적으로 변수 간 독립성에 대한 귀무가설이 타당한지를 평가하기 위해 <행 × 열> 분할표를 함께 사용  

🎲 관측된 데이터가 독립성 가정을 따르는지 검정  
 

<br>  

🎲 용어 정리  

- 카이제곱통계량 (chi-square statistic) : 기댓값으로부터 어떤 관찰값까지의 거리를 나타내는 측정치  
  
- 기댓값 (expectation) : 어떤 가정(귀무가설)으로부터 데이터가 발생할 때, 그에 대해 기대하는 정도  
   
- d.f. (degrees of freedom) : 자유도  
   
<br>  

***  

## 🎰 09.01. 카이제곱검정 : 재표본추출 방법  

🎲 분할표 : 서로 다른 3가지 헤드라인에 대한 웹 테스트 결과  

|-|헤드라인 A|헤드라인 B|헤드라인 C|  
|-|-|-|-|  
|클릭|14|8|12|  
|클릭하지 않음|986|992|988|  

<br>  

🎲 재표본추출을 통해 클릭률이 우연히 발생할 수 있는 것보다 유의미한 정도로 큰 것인지를 검정함  

🎲 이를 위해서는 클릭 수에 대한 기댓값과 그 분포가 필요하며, 이 경우 각 헤드라인 모두가 동일한 클릭률을 갖는다는 귀무가설을 가짐  

🎲 전체 클릭률은 34 / 3000 이며, 귀무 가설 하에 분할표는 아래와 같음  

🎲 분할표 : 3가지 헤드라인이 모두 같은 클릭률을 가진다고 가정했을 때의 기댓값  

<br>  


|-|헤드라인 A|헤드라인 B|헤드라인 C|  
|-|-|-|-|  
|클릭|11.33|11.33|11.33|  
|클릭하지 않음|988.67|988.67|988.67|  

<br>  

🎲 피어슨 잔차 : $R = \frac{관측값-기댓값}{\sqrt{기댓값}}$ -> 실제 횟수와 기대한 횟수 간의 차이  

<br>  


|-|헤드라인 A|헤드라인 B|헤드라인 C|  
|-|-|-|-|  
|클릭|11.33|11.33|11.33|  
|클릭하지 않음|988.67|988.67|988.67|  

<br>  

🎲 피어슨잔차 분할표  

<br>  


|-|헤드라인 A|헤드라인 B|헤드라인 C|  
|-|-|-|-|  
|클릭|0.792|-0.990|0.198|  
|클릭하지 않음|-0.085|0.106|-0.021|  

<br>  

🎲 카이제곱통계량 : 피어슨 잔차들의 제곱합  

$X = \sum_{r}\sum_{c}R^2  (단, r과 c는 각각 행의 수와 열의 수를 의미함)$  

<br>  

🎲 이 카이제곱통계량으로 얻는 값이 귀무가설로부터 얻는 값보다 큰지 여부 확인  

<br>  

🎲 재표본추출 알고리즘  

1. 34개의 1(클릭한 경우)과 2,966개의 0(클릭하지 않은 경우)이 들어 있는 상자 생성  
2. 상자의 내용물을 잘 섞은 다음 1,000개의 표본을 세 번씩 가져와서 각각의 클릭 수를 계산  
3. 이렇게 얻은 횟수와 기대한 횟수의 차이를 제곱해서 합산  
4. 2~3 단계를 1,000번 반복  
5. 재표본추출을 통해 얻은 편차의 제곱합이 얼마나 자주 관측값을 초과하는가 -> p-value  
 
<br>  

***  

## 🎰 09.02. 카이제곱검정 : 통계적 이론  

🎲 점근적인 통계 이론은 카이제곱통계량의 분포가 카이제곱분포로 근사화될 수 있음을 보여줌  

🎲 카이제곱분포 : 카이제곱통계량을 비교할 독립성 가정을 포함한 기준분포  


🎲 적절한 표준 카이제곱분포는 자유도에 의해 결정되며, 분할표에서 자유도는 행 (r)과 열 (c)의 수와 관련이 있음  

🎲 자유도 = $(r-1)(c-1)$  

🎲 카이제곱분포는 일반적으로 한쪽으로 기울어져 있고 오른쪽으로 긴 꼬리가 존재함  

🎲 관찰된 통계량이 카이제곱분포의 바깥쪽에 위치할수록 p 값은 낮아짐 -> 통계적으로 유의미함  


![image](https://user-images.githubusercontent.com/65170165/216074228-d247beaf-3126-45a6-896a-954e1bfe5e12.png)  

<br>  

***  

## 🎰 09.03. 피셔의 정확검정  

🎲 카이제곱분포는 재표본 검정에 있어 좋은 근사치를 제공함  

🎲 사건 발생 횟수가 매우 낮은 (한 자리 숫자이거나, 5개 이하인 경우) 예외적인 경우에도 재표본추출 방법을 통해 더 정확한 p 값을 얻을 수 있음  

🎲 피셔의 정확검정 : 발생할 수 있는 모든 조합(순열)을 열거하고, 빈도를 집계해서 관찰된 결과가 얼마나 극단적으로 발생하는지 정확하게 결정함  

🎲 다만 어느 값이 매우 낮고 다른 값이 상대적으로 매우 높은 경우 (전환율 계산에서 분모) 모든 순열을 계산하기 어렵기에, 완전한 정확검정 대신 순열검정을 수행해야 할 수 있음  

<br>  

***  

## 🎰 09.04. 데이터 과학과의 관련성  

🎲 카이제곱검정이나 피셔의 정확검정은 어떤 효과가 실제인지 혹은 우연인지 알고 싶을 때 사용함  

🎲 즉, 통계적 유의성을 결정하는 것이 커아제곱검정의 일반적인 역할임  

🎲 하지만 데이터 과학에서의 목적은 단순히 통계적 유의성 발견이 아닌 최적의 처리 방법을 찾는 것이므로, 더 나은 해결책이 필요함  

<br>  


🎲 데이터 과학에 있어 카이제곱 검정과 피셔의 정확검정을 통해 적합한 표본크기를 판별하는 것은 유용함  

- 특히 웹 실험에 적합한 표본 크기를 구할 때에는 낮은 클릭률로 인해 수많은 실험에도 불구하고 집계비율이 낮아 확실한 결론을 구하기 힘들 수 있음  
   
- 이 때 카이제곱 검정과 피셔의 정확검정을 통해 적합한 표본크기를 판별함  
 
<br>  

🎲 또한 카이제곱검정이나 이와 유사한 재표본추출 시율레이션을 필터로 사용함  

- 어떤 효과나 특징에 대해 기본적인 유의성 검정을 넘어 더 심층적인 분석의 필요 여부를 결정함  
   
<br>  

***  







